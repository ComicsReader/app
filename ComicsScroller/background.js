(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var ObjectAssign=require("object-assign"),Comics_sf=require("./app/comics_sf.js"),Comics_8=require("./app/comics_8.js"),Comics_dm5=require("./app/comics_dm5.js"),collected={collected:[]},readed={readed:[]},update={update:[]},redirectLocal=function(e,t,c){var o=/http\:\/\/new\.comicvip\.com\/show\/(.*-\d*.html\?ch=\d*)/,s=/http\:\/\/comic\.sfacg\.com\/(HTML\/\w*\/\w*\/.*)/,r=/http\:\/\/www\.manben\.com\/(m\d*\/)/,a=/http\:\/\/(tel||www)\.dm5\.com\/(m\d*\/)/;if(Comics_8.regex.test(c.url)&&"loading"===t.status){var n=o.exec(c.url)[1];chrome.tabs.update(c.id,{url:chrome.extension.getURL("reader.html")+"/#/site/comics8/chapter/"+n}),ga("send","event","8comics view")}else if(Comics_sf.regex.test(c.url)&&"loading"===t.status){var n=s.exec(c.url)[1];chrome.tabs.update(c.id,{url:chrome.extension.getURL("reader.html")+"/#/site/sf/chapter/"+n}),ga("send","event","sf view")}else if((Comics_dm5.regex.test(c.url)||Comics_dm5.dm5regex.test(c.url))&&"loading"===t.status){var n="";n=a.test(c.url)?a.exec(c.url)[2]:r.exec(c.url)[1],chrome.tabs.update(c.id,{url:chrome.extension.getURL("reader.html")+"/#/site/dm5/chapter/"+n}),ga("send","event","dm5 view")}};chrome.notifications.onClicked.addListener(function(e){chrome.tabs.create({url:e})});var comicsQuery=function(){chrome.storage.local.get("collected",function(e){for(var t=0;t<e.collected.length;++t){var c=e.collected[t].url,o=e.collected[t].menuItems,s=new XMLHttpRequest;s.open("GET",c),s.responseType="document","sf"===e.collected[t].site?s.onload=function(e,t,c,o,s,r){return function(){r.backgroundOnload(e,t,c,o,s)}}(c,o,s,e,t,Comics_sf):"comics8"===e.collected[t].site?s.onload=function(e,t,c,o,s,r){return function(){r.backgroundOnload(e,t,c,o,s)}}(c,o,s,e,t,Comics_8):"dm5"===e.collected[t].site&&(s.onload=function(e,t,c,o,s,r){return function(){r.backgroundOnload(e,t,c,o,s)}}(c,o,s,e,t,Comics_dm5)),s.send()}})};chrome.tabs.onUpdated.addListener(redirectLocal),chrome.storage.local.get("readed",function(e){var t=ObjectAssign(readed,e);chrome.storage.local.set(t)}),chrome.storage.local.get("update",function(e){var t=ObjectAssign(update,e);chrome.storage.local.set(t)}),chrome.storage.local.get("collected",function(e){var t=ObjectAssign(collected,e);chrome.storage.local.set(t,function(){setInterval(function(){comicsQuery()},6e4)})}),function(e,t,c,o,s,r,a){e.GoogleAnalyticsObject=s,e[s]=e[s]||function(){(e[s].q=e[s].q||[]).push(arguments)},e[s].l=1*new Date,r=t.createElement(c),a=t.getElementsByTagName(c)[0],r.alocal=1,r.src=o,a.parentNode.insertBefore(r,a)}(window,document,"script","https://ssl.google-analytics.com/analytics.js","ga"),ga("create","UA-59728771-1","auto"),ga("set","checkProtocolTask",null),ga("send","pageview");


},{"./app/comics_8.js":3,"./app/comics_dm5.js":4,"./app/comics_sf.js":5,"object-assign":2}],2:[function(require,module,exports){
"use strict";function ToObject(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}module.exports=Object.assign||function(e,t){for(var n,r,c=ToObject(e),o=1;o<arguments.length;o++){n=arguments[o],r=Object.keys(Object(n));for(var u=0;u<r.length;u++)c[r[u]]=n[r[u]]}return c};


},{}],3:[function(require,module,exports){
var ObjectAssign=require("object-assign"),comics={regex:/http\:\/\/new\.comicvip\.com\/show\/(.*-\d*.html\?ch=\d*)/,baseURL:"http://new.comicvip.com/show/",comicspageURL:"http://www.comicvip.com/html/",handleUrlHash:function(){var t=window.location.hash;if(this.site=/site\/(\w*)/.exec(t)[1],this.pageURL=/chapter\/.*-(\d*\.html)\?/.exec(t)[1],this.chapterNum=/chapter\/.*\?ch\=(\d*)/.exec(t)[1],this.prefixURL=/chapter\/(.*\?ch\=)\d*/.exec(t)[1],this.indexURL=this.comicspageURL+this.pageURL,/#$/.test(t))window.history.replaceState("",document.title,"#/site/comics8/chapter/"+/chapter\/(.*)#$/.exec(t)[1]);else{document.getElementById("comics_panel").innerHTML="";for(var e=-1,c=0;c<this.state.menuItems.length;++c)if(this.state.menuItems[c].payload===this.baseURL+this.prefixURL+this.chapterNum&&-1===e){e=c,this.lastIndex=e,this._getImage(e,this.chapterNum),this.setState({selectedIndex:e,chapter:this.state.menuItems[e].text,pageratio:""});break}}},getChapter:function(t){return t.querySelectorAll(".Vol , .ch , #lch")},getChapterUrl:function(t){var e=/cview\(\'(.*-\d*\.html)\',(\d*)/.exec(t),c=e[2],i=e[1],s="";return(4==c||6==c||12==c||22==c)&&(s="http://new.comicvip.com/show/cool-"),(1==c||17==c||19==c||21==c)&&(s="http://new.comicvip.com/show/cool-"),(2==c||5==c||7==c||9==c)&&(s="http://new.comicvip.com/show/cool-"),(10==c||11==c||13==c||14==c)&&(s="http://new.comicvip.com/show/best-manga-"),(3==c||8==c||15==c||16==c||18==c||20==c)&&(s="http://new.comicvip.com/show/best-manga-"),i=i.replace(".html","").replace("-",".html?ch="),s+i},getTitleName:function(t){return t.querySelector("body > table:nth-child(7) > tbody > tr > td > table > tbody > tr:nth-child(1) > td:nth-child(2) > table:nth-child(1) > tbody > tr:nth-child(1) > td > table > tbody > tr > td:nth-child(2) > font").textContent},getCoverImg:function(t){return t.querySelector("body > table:nth-child(7) > tbody > tr > td > table > tbody > tr:nth-child(1) > td:nth-child(1) > img").src},setImages:function(index,doc){var script=doc.evaluate('//*[@id="Form1"]/script/text()',doc,null,XPathResult.ANY_TYPE,null).iterateNext().textContent.split("eval")[0];eval(script);var ch=/.*ch\=(.*)/.exec(doc.URL)[1];ch.indexOf("#")>0&&(ch=ch.split("#")[0]);var p=1,f=50;ch.indexOf("-")>0&&(p=parseInt(ch.split("-")[1]),ch=ch.split("-")[0]),ch=""==ch?1:parseInt(ch);for(var ss=function(t,e,c,i){var s=t.substring(e,e+c);return null==i?s.replace(/[a-z]*/gi,""):s},nn=function(t){return 10>t?"00"+t:100>t?"0"+t:t},mm=function(t){return parseInt((t-1)/10)%10+(t-1)%10*3},c="",cc=cs.length,j=0;cc/f>j;j++)if(ss(cs,j*f,4)==ch){c=ss(cs,j*f,f,f),ci=j;break}""==c&&(c=ss(cs,cc-f,f),ch=c),ps=ss(c,7,3),this.pageMax=ps;for(var img=[],i=0;i<this.pageMax;++i){for(var c="",cc=cs.length,j=0;cc/f>j;j++)if(ss(cs,j*f,4)==ch){c=ss(cs,j*f,f,f),ci=j;break}""==c&&(c=ss(cs,cc-f,f),ch=chs),img[i]="http://img"+ss(c,4,2)+".8comic.com/"+ss(c,6,1)+"/"+ti+"/"+ss(c,0,4)+"/"+nn(i+1)+"_"+ss(c,mm(i+1)+10,3,f)+".jpg"}this.images=img,this.appendImage(index)},backgroundOnload:function(t,e,c,i,s){var a=c.response,o=this.getChapter(a),h=this.getTitleName(a),r=this.getCoverImg(a),n=[],l={},m={};m.payload=Comics_8.getChapterUrl(o[o.length-2].getAttribute("onclick")),m.text=o[o.length-1].textContent,n.push(m);for(var p=!1,d=0;d<e.length;++d)if(e[d].payload===m.payload){p=!0;break}p===!1&&e.length>0&&(ObjectAssign(l,{url:t,title:h,site:"comics8",iconUrl:r,lastReaded:m}),chrome.notifications.create(m.payload,{type:"image",iconUrl:"img/comics-64.png",title:"Comics Update",message:h+"  "+l.lastReaded.text,imageUrl:r}),chrome.storage.local.get("update",function(t){t.update.push(this);var e=t.update.length.toString();chrome.browserAction.setBadgeText({text:e}),chrome.storage.local.set(t)}.bind(l)));for(var g=o.length-3;g>=0;--g){var m={};m.payload=Comics_8.getChapterUrl(o[g].getAttribute("onclick")),m.text=o[g].textContent.trim(),n.push(m);for(var l={},p=!1,d=0;d<e.length;++d)if(e[d].payload===m.payload){p=!0;break}p===!1&&e.length>0&&(ObjectAssign(l,{url:t,title:h,site:"comics8",iconUrl:r,lastReaded:m}),chrome.notifications.create(m.payload,{type:"image",iconUrl:"img/comics-64.png",title:"Comics Update",message:h+"  "+l.lastReaded.text,imageUrl:r}),chrome.storage.local.get("update",function(t){t.update.push(this);var e=t.update.length.toString();chrome.browserAction.setBadgeText({text:e}),chrome.storage.local.set(t)}.bind(l)))}i.collected[s].menuItems=n,chrome.storage.local.set(i)}};module.exports=comics;


},{"object-assign":2}],4:[function(require,module,exports){
var comics={regex:/http\:\/\/www\.manben\.com\/(m\d*\/)/,dm5regex:/http\:\/\/(tel||www)\.dm5\.com\/(m\d*\/)/,baseURL:"http://www.manben.com/",handleUrlHash:function(){var e=window.location.hash;if(this.site=/site\/(.*)/.exec(e)[1],this.chapterURL=this.baseURL+/chapter\/(.*\/)/.exec(e)[1],/#$/.test(e))window.history.replaceState("",document.title,"#/site/dm5/chapter/"+/chapter\/(.*\/)/.exec(e)[1]);else{document.getElementById("comics_panel").innerHTML="";for(var t=-1,a=0;a<this.state.menuItems.length;++a)if(this.state.menuItems[a].payload===this.chapterURL&&-1===t){t=a,this.lastIndex=t,this._getImage(t,this.chapterURL),this.setState({selectedIndex:t,chapter:this.state.menuItems[t].text,pageratio:""});break}}},getChapter:function(e){var t=e.querySelectorAll(".nr6.lan2>li>.tg");return t},getTitleName:function(e){return e.querySelector(".inbt_title_h2").textContent},getCoverImg:function(e){return e.querySelector(".innr91>img").src},setImages:function(index,xhr){var doc=xhr.response,script1=/<script type\=\"text\/javascript\">(.*)reseturl/.exec(doc.head.innerHTML)[1];eval(script1),this.pageMax=DM5_IMAGE_COUNT;for(var img=[],i=0;i<this.pageMax;++i)img[i]=doc.URL+"chapterfun.ashx?cid="+DM5_CID.toString()+"&page="+(i+1)+"&key=&language=1";this.images=img,this.appendImage(index)},backgroundOnload:function(e,t,a,i,r){for(var s=a.response,n=this.getChapter(s),o=this.getTitleName(s),c=this.getCoverImg(s),h=[],l={},m=0;m<n.length;++m){var g={};g.payload=n[m].href,g.text=n[m].textContent,h.push(g);for(var d=!1,p=0;p<t.length;++p)if(t[p].payload===g.payload){d=!0;break}d===!1&&t.length>0&&(ObjectAssign(l,{url:e,title:o,site:"dm5",iconUrl:c,lastReaded:g}),chrome.notifications.create(g.payload,{type:"image",iconUrl:"img/comics-64.png",title:"Comics Update",message:o+"  "+l.lastReaded.text,imageUrl:c}),chrome.storage.local.get("update",function(e){e.update.push(this);var t=e.update.length.toString();chrome.browserAction.setBadgeText({text:t}),chrome.storage.local.set(e)}.bind(l)))}i.collected[r].menuItems=h,chrome.storage.local.set(i)}};module.exports=comics;


},{}],5:[function(require,module,exports){
var ObjectAssign=require("object-assign"),comics={regex:/http\:\/\/comic\.sfacg\.com\/(HTML\/\w*\/\w*\/.*)/,baseURL:"http://comic.sfacg.com/",handleUrlHash:function(){var e=window.location.hash;if(this.site=/site\/(\w*)\//.exec(e)[1],this.pageURL=/chapter\/(HTML\/\w*\/)/.exec(e)[1],this.chapterURL=this.baseURL+/chapter\/(.*)$/.exec(e)[1],this.indexURL=this.baseURL+this.pageURL,/#$/.test(e))window.history.replaceState("",document.title,"#/site/sf/chapter/"+/chapter\/(.*\/)/.exec(e)[1]);else{document.getElementById("comics_panel").innerHTML="";for(var t=-1,i=0;i<this.state.menuItems.length;++i)if(this.state.menuItems[i].payload===this.chapterURL&&-1===t){t=i,this.lastIndex=t,this._getImage(t,this.chapterURL),this.setState({selectedIndex:t,chapter:this.state.menuItems[t].text,pageratio:""});break}}},getChapter:function(e){var t=e.querySelectorAll(".serialise_list>li>a");return t},getTitleName:function(e){return e.querySelector("body > table:nth-child(8) > tbody > tr > td:nth-child(1) > table:nth-child(2) > tbody > tr > td > h1 > b").textContent},getCoverImg:function(e){return e.querySelector(".comic_cover>img").src},setImages:function(index,xhr){eval(xhr.response);var name="picHost=",picHost=hosts[0],img=[];this.pageMax=picCount;for(var i=0;i<this.pageMax;i++)img[i]=picHost+picAy[i];this.images=img,this.appendImage(index)},backgroundOnload:function(e,t,i,a,s){for(var o=i.response,r=this.getChapter(o),c=this.getTitleName(o),n=this.getCoverImg(o),h=[],l={},g=0;g<r.length;++g){var m={};m.payload=r[g].href,m.text=r[g].textContent,h.push(m);for(var p=!1,d=0;d<t.length;++d)if(t[d].payload===m.payload){p=!0;break}!p&&t.length>0&&(ObjectAssign(l,{url:e,title:c,site:"sf",iconUrl:n,lastReaded:m}),chrome.notifications.create(m.payload,{type:"image",iconUrl:"img/comics-64.png",title:"Comics Update",message:c+"  "+l.lastReaded.text,imageUrl:n}),chrome.storage.local.get("update",function(e){e.update.push(this);var t=e.update.length.toString();chrome.browserAction.setBadgeText({text:t}),chrome.storage.local.set(e)}.bind(l)))}a.collected[s].menuItems=h,chrome.storage.local.set(a)}};module.exports=comics;


},{"object-assign":2}]},{},[1]);
